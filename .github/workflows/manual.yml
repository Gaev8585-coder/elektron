name: Manual Data Update

on:
  # –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ GitHub
  workflow_dispatch:
    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    inputs:
      logLevel:
        description: '–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è'
        required: true
        default: 'warning'
      environment:
        description: '–û–∫—Ä—É–∂–µ–Ω–∏–µ'
        required: false
        default: 'staging'

jobs:
  update-sensor-data:
    runs-on: ubuntu-latest
    steps:
      # –®–∞–≥ 1: –ü–æ–ª—É—á–∞–µ—Ç –∫–æ–¥ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      - name: Checkout repository
        uses: actions/checkout@v4
        
      # –®–∞–≥ 2: –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à—É —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É)
      - name: Update data.json
        run: |
          # –ó–¥–µ—Å—å –ø—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å –µ–µ –Ω–∞ —Å–≤–æ—é.
          echo '{
            "temperature": 23.5,
            "humidity": 45.0,
            "voltage": 12.34,
            "lastUpdate": "$(date -u +"%Y-%m-%dT%H:%M:%S.%3NZ")",
            "status": "manual-update"
          }' > docs/data.json
          
      # –®–∞–≥ 3: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
      - name: Show updated file content
        run: cat docs/data.json
        
      # –®–∞–≥ 4: –§–∏–∫—Å–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      - name: Commit and push changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add docs/data.json
          git commit -m "ü§ñ Manual update: Sensor data refreshed via workflow_dispatch"
          git push
